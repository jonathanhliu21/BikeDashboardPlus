function get_dist_lat_lon(t,i){var e=t.trim().split(","),n=i.trim().split(","),a=parseFloat(e[0]),o=parseFloat(e[1]),t=parseFloat(n[0]),i=parseFloat(n[1]),e=a*Math.PI/180,n=t*Math.PI/180,a=(t-a)*Math.PI/180,o=(i-o)*Math.PI/180,o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e)*Math.cos(n)*Math.sin(o/2)*Math.sin(o/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function calc_tot_dist(i){var e=0,n=i[0];for(let t=0;t<i.length;t++){var a=i[t];if("PAUSED"!==a||t===i.length-1){if("PAUSED"==a&&t===i.length-1)break;e+=get_dist_lat_lon(a,n),n=a}else n=i[t+1]}return e}function conv_dist_unit(t,i){return("0"===i?t/1609:t/1e3).toFixed(3)}function conv_sm_dist_unit(t,i){t=conv_dist_unit(t,i);return("0"!==i?1e3*(t-Math.floor(t)):5280*(t-Math.floor(t))).toFixed(3)}function handle_track_data(t,i){var e=t.trimEnd().split("\n"),n=calc_tot_dist(e),a=e[0],o=e[e.length-1],r=L.map("mapid").setView(a.trim().split(","),15);L.tileLayer("https://a.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,tileSize:512,zoomOffset:-1,detectRetina:!0}).addTo(r),L.marker(a.trim().split(","),{title:"start",icon:new L.Icon({iconUrl:"/static/img/start.png",iconSize:40})}).addTo(r),L.marker(o.trim().split(","),{title:"end",icon:new L.Icon({iconUrl:"/static/img/end.png",iconSize:40})}).addTo(r);for(var s=0;s<e.length;){let t=[];for(;s<e.length&&"PAUSED"!==e[s];)t.push(e[s].trim().split(",")),s++;L.polyline(t,{color:"blue",smoothFactor:"4.0"}).addTo(r);var l=a.trim().split(","),c=o.trim().split(",");for(t[0][0]===l[0]&&t[0][1]===l[1]||L.marker(t[0],{title:"resumed",icon:new L.Icon({iconUrl:"/static/img/resume.png",iconSize:40})}).addTo(r),t[t.length-1][0]===c[0]&&t[t.length-1][1]===c[1]||L.marker(t[t.length-1],{title:"paused",icon:new L.Icon({iconUrl:"/static/img/pause.png",iconSize:40})}).addTo(r);s<e.length&&"PAUSED"===e[s];)s++}var d=0==i?"mi":"km",p=conv_sm_dist_unit(n,i),t=0==i?"ft":"m";new Vue({el:"#dist",delimiters:["[[","]]"],data:{distance1:conv_dist_unit(n,i),distance2:p,unit1:d,unit2:t}})}