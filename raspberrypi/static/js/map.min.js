function get_dist_lat_lon(t,i){const e=t.trim().split(","),n=i.trim().split(","),a=parseFloat(e[0]),o=parseFloat(e[1]),r=parseFloat(n[0]),s=parseFloat(n[1]),l=a*Math.PI/180,c=r*Math.PI/180,d=(r-a)*Math.PI/180,p=(s-o)*Math.PI/180,m=Math.sin(d/2)*Math.sin(d/2)+Math.cos(l)*Math.cos(c)*Math.sin(p/2)*Math.sin(p/2);return 6371e3*(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)))}function calc_tot_dist(t){var i=0,e=t[0];for(let n=0;n<t.length;n++){let a=t[n];if("PAUSED"!==a||n===t.length-1){if("PAUSED"==a&&n===t.length-1)break;i+=get_dist_lat_lon(a,e),e=a}else e=t[n+1]}return i}function conv_dist_unit(t,i){return"0"===i?(t/1609).toFixed(3):(t/1e3).toFixed(3)}function conv_sm_dist_unit(t,i){var e=conv_dist_unit(t,i);return"0"===i?5280*(e-Math.floor(e)):1e3*(e-Math.floor(e))}function handle_track_data(t,i){var e=t.trimEnd().split("\n"),n=calc_tot_dist(e),a=e[0],o=e[e.length-1],r=L.map("mapid").setView(a.trim().split(","),15);L.tileLayer("https://a.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,tileSize:512,zoomOffset:-1,detectRetina:!0}).addTo(r),L.marker(a.trim().split(","),{title:"start",icon:new L.Icon({iconUrl:"/static/img/start.png",iconSize:40})}).addTo(r),L.marker(o.trim().split(","),{title:"end",icon:new L.Icon({iconUrl:"/static/img/end.png",iconSize:40})}).addTo(r);for(var s=0;s<e.length;){let t=[];for(;s<e.length&&"PAUSED"!==e[s];)t.push(e[s].trim().split(",")),s++;L.polyline(t,{color:"blue",smoothFactor:"4.0"}).addTo(r);let i=a.trim().split(","),n=o.trim().split(",");for(t[0][0]===i[0]&&t[0][1]===i[1]||L.marker(t[0],{title:"resumed",icon:new L.Icon({iconUrl:"/static/img/resume.png",iconSize:40})}).addTo(r),t[t.length-1][0]===n[0]&&t[t.length-1][1]===n[1]||L.marker(t[t.length-1],{title:"paused",icon:new L.Icon({iconUrl:"/static/img/pause.png",iconSize:40})}).addTo(r);s<e.length&&"PAUSED"===e[s];)s++}var l=0==i?"mi":"km",c=conv_sm_dist_unit(n,i),d=0==i?"ft":"m";new Vue({el:"#dist",delimiters:["[[","]]"],data:{distance1:conv_dist_unit(n,i),distance2:c,unit1:l,unit2:d}})}