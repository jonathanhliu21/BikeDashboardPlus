function get_dist_lat_lon(t,e){const i=t.trim().split(","),a=e.trim().split(","),n=parseFloat(i[0]),o=parseFloat(i[1]),r=parseFloat(a[0]),l=parseFloat(a[1]),s=n*Math.PI/180,c=r*Math.PI/180,d=(r-n)*Math.PI/180,h=(l-o)*Math.PI/180,p=Math.sin(d/2)*Math.sin(d/2)+Math.cos(s)*Math.cos(c)*Math.sin(h/2)*Math.sin(h/2);return 6371e3*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))}function calc_tot_dist(t){var e=0,i=t[0];for(let a=0;a<t.length;a++){let n=t[a];if("PAUSED"!==n||a===t.length-1){if("PAUSED"==n&&a===t.length-1)break;e+=get_dist_lat_lon(n,i),i=n}else i=t[a+1]}return e}function conv_dist_unit(t,e){return"0"===e?(t/1609).toFixed(3):(t/1e3).toFixed(3)}function conv_sm_dist_unit(t,e){var i=conv_dist_unit(t,e);return"0"===e?(5280*(i-Math.floor(i))).toFixed(3):(1e3*(i-Math.floor(i))).toFixed(3)}function handle_track_data(t,e){for(var i=t.trimEnd().split("\n");i.length>0&&("PAUSED"===i[i.length-1]||""===i[i.length-1]);)i.pop();if(new Vue({el:"#data_err",delimiters:["[[","]]"],data:{text:i.length<=0?"See weird text? No map? That's because there is a data error. Consider deleting the file.":""},methods:{warn:function(){var t=window.location.pathname.slice(5,window.location.pathname.length);confirm("Are you sure you want to delete this file PERMANENTLY? There will be NO WAY to recover this file.")&&axios.post(`/map/delete/${t}`,{}).then(t=>{alert("Successfully deleted"),window.location.href="/map"}).catch(t=>{alert("Error in deleting: ".concat(t))})}}}),!(i.length<=0)){var a=calc_tot_dist(i),n=i[0],o=i[i.length-1],r=L.map("mapid").setView(n.trim().split(","),15);L.tileLayer("https://a.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,tileSize:512,zoomOffset:-1,detectRetina:!0}).addTo(r),L.marker(n.trim().split(","),{title:"start",icon:new L.Icon({iconUrl:"/static/img/start.png",iconSize:40})}).addTo(r),L.marker(o.trim().split(","),{title:"end",icon:new L.Icon({iconUrl:"/static/img/end.png",iconSize:40})}).addTo(r);for(var l=0;l<i.length;){let t=[];for(;l<i.length&&"PAUSED"!==i[l];)t.push(i[l].trim().split(",")),l++;L.polyline(t,{color:"blue",smoothFactor:"4.0"}).addTo(r);let e=n.trim().split(","),a=o.trim().split(",");for(t[0][0]===e[0]&&t[0][1]===e[1]||L.marker(t[0],{title:"resumed",icon:new L.Icon({iconUrl:"/static/img/resume.png",iconSize:40})}).addTo(r),t[t.length-1][0]===a[0]&&t[t.length-1][1]===a[1]||L.marker(t[t.length-1],{title:"paused",icon:new L.Icon({iconUrl:"/static/img/pause.png",iconSize:40})}).addTo(r);l<i.length&&"PAUSED"===i[l];)l++}var s=0==e?"mi":"km",c=conv_sm_dist_unit(a,e),d=0==e?"ft":"m";new Vue({el:"#dist",delimiters:["[[","]]"],data:{distance1:conv_dist_unit(a,e),distance2:c,unit1:s,unit2:d}}),new Vue({el:"#raw_data",delimiters:["[[","]]"],data:{arr_:i}})}}